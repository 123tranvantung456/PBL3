package com.pbl3.service;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Date;
import java.util.LinkedList;

import com.pbl3.model.HistoryOfTestModel;
import com.pbl3.model.TestsModel;

public class HistoryOfTestService extends BaseService{
	
	// query all history of test 
	public static LinkedList<HistoryOfTestModel> all(int userID, int testID) {
		LinkedList<HistoryOfTestModel> historyOfTestModels = new LinkedList<HistoryOfTestModel>();
		try {
			Connection connection = getConnection();
			PreparedStatement preparedStatement = connection.prepareStatement("SELECT historyoftest.*  FROM user INNER JOIN historyoftest ON user.userID = historyoftest.userID INNER JOIN test ON historyoftest.testID = test.testID WHERE test.testID = ? AND user.userID = ?;");
			preparedStatement.setInt(1, userID);
			preparedStatement.setInt(2, testID);
			ResultSet resultSet = preparedStatement.executeQuery();
			while(resultSet.next()) {
				int historyOfTestID = resultSet.getInt(1);
//				int userID = resultSet.getInt(2);
//				int testID = resultSet.getInt(3);
				Date date = resultSet.getDate(4);
				int score = resultSet.getInt(5);
				HistoryOfTestModel historyOfTestModel = new HistoryOfTestModel(historyOfTestID, userID, testID, date, score);   
				historyOfTestModels.add(historyOfTestModel);             
			}
			System.out.println("size cua historyOfTestModels: " + historyOfTestModels.size());
			return historyOfTestModels; 
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return historyOfTestModels;
	}
}
